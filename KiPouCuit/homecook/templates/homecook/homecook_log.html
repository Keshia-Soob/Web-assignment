{% extends "base.html" %}
{% load static %}

{% block title %}Homecook Log{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'homecook/css/homecook_log.css' %}">

<div class="homecook-container">
  <!-- Homecook Profile -->
  <div class="homecook-profile">
    {% if homecook and homecook.profile_picture %}
      {# 1. If HomeCook has its own picture, use it #}
      <img src="{{ homecook.profile_picture.url }}" alt="Profile Picture" class="profile-pic">
    {% elif homecook and homecook.user.userprofile.photo %}
      {# 2. Otherwise, fall back to the user's profile photo #}
      <img src="{{ homecook.user.userprofile.photo.url }}" alt="Profile Picture" class="profile-pic">
    {% else %}
      {# 3. Otherwise, show the default icon #}
      <img src="{% static 'homecook/images/profile.png' %}" alt="Profile Picture" class="profile-pic">
    {% endif %}

    {% if homecook %}
      <h2 class="homecook-name">{{ homecook.name }} {{ homecook.surname }}</h2>
      <p class="homecook-specialty">{{ homecook.get_cuisine_display }}</p>
    {% else %}
      <h2 class="homecook-name">HomeCook</h2>
      <p class="homecook-specialty">—</p>
    {% endif %}
  </div>

  <!-- Orders Section -->
  <div class="orders-section">
    <h3>Orders to Prepare</h3>

    {% if items %}
      {% for it in items %}
      <div class="order-item">
        <div class="dish-info">
          <img src="{{ it.menu_item.display_image_url }}" alt="Meal" class="dish-image">
          <div class="dish-details">
            <h4>{{ it.menu_item.name }}</h4>
            <p>Client: <strong>N/A</strong></p>
            <p>Qty: {{ it.quantity }}</p>
          </div>
        </div>
        <div class="order-actions">
          <form action="{% url 'mark_order_ready' it.id %}" method="post">
            {% csrf_token %}
            <button class="mark-ready" type="submit">Mark as Ready</button>
          </form>
        </div>
      </div>
      {% endfor %}
    {% else %}
      <p>No pending {% if homecook %}{{ homecook.get_cuisine_display }}{% else %}—{% endif %} orders right now.</p>
    {% endif %}
  </div>
</div>
{% endblock %}